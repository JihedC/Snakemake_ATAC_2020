# Snakemake pipepine for (Illumina) paired-end ATAC-Seq data

## Aim

Snakemake pipeline made for reproducible analysis of paired-end Illumina ATAC-seq data. The desired output of this pipeline are:

* Quality check files of raw data and trimmed data. Reads are processed and quality reports are generated by fastqc tool. Fastqc reports are in html format, so we can visualize them easily.

* Peaks information files. These files gather the information processed by HMMRATAC/MACS2.

*

## Content of the repository

* **Snakefile** serves as a list for snakemake to 'monitor'. In Snakefile, there are ```rules``` that contain ```output```, ```input``` and ```shell```. ```shell``` item shows the command lines that produce ```output``` from ```input```. If snakemake finds any of input or output files missing, it will report errors.

* **Config.yaml** contains all the parameters you want to refer to, such as directory paths, genome file link, rule parameters, etc. You can also save those rarely-modified files such as ```genome.info``` in the configuration file. **Note: all paths in snakemake files are relative!**

* **Envs/** contains conda environment sheets. Every rule that requires tool installation from conda has a separate *.yaml file. ```channels``` refers to which channel of conda you use, and ```dependecies``` refers to the exact version of this tool. To avoid tool conflicts with python, we usually use an older version of a tool.

* **units.tsv** is a _tab separated value files_ containing information about the experiment name, the condition of the experiment (control or treatment) and the path to the fastq files relative to the Snakefile. Change this file according to your samples.

## How it works ?

* **rule download_genome:** Download genome.

* **rule index_genome:** Indexing a genome helps with accelerating mapping algorithm.

* **rule fastqc:** Check the quality of sequenced reads.

* **rule trimmomatic** Trim the adapters and N bases.

* **rule trimmed_fastqc** As confirmation, check the quality again after reads are trimmed.

* **rule mapping** Align trimmed reads with indexed genome.

* **rule sort**


## How to test it on your computer ?

* **Change genome file** Change 'genome_fasta_url' item in configfile to download the genome that you want to reference.
